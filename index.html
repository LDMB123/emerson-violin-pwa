<!DOCTYPE html>
<html lang="en" data-ui-mode="child">

<head>
  <meta charset="utf-8" />
  <meta name="viewport"
    content="width=device-width, initial-scale=1, viewport-fit=cover, user-scalable=no, maximum-scale=1.0, minimum-scale=1.0" />
  <meta name="theme-color" content="#F56B49" />
  <meta http-equiv="Content-Security-Policy"
    content="default-src 'self'; script-src 'self' 'wasm-unsafe-eval'; style-src 'self' 'unsafe-inline' https://fonts.googleapis.com; img-src 'self' blob: data:; media-src 'self' blob:; font-src 'self' data: https://fonts.gstatic.com; connect-src 'self'; worker-src 'self'; object-src 'none'; base-uri 'self'; form-action 'self'; manifest-src 'self'" />
  <meta name="referrer" content="strict-origin-when-cross-origin" />
  <meta http-equiv="Permissions-Policy" content="microphone=(self), camera=(), geolocation=(), payment=(), usb=()" />

  <!-- PWA / iPadOS 26.2 Capable -->
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent" />
  <meta name="apple-touch-fullscreen" content="yes" />
  <meta name="apple-mobile-web-app-title" content="Panda Violin" />

  <!-- Description -->
  <meta name="description"
    content="Learn violin with your Red Panda coach! Fun games, offline practice tools, and reference tones for Emerson." />

  <!-- PWA Assets -->
  <link rel="manifest" href="./manifest.webmanifest" />
  <link rel="apple-touch-icon" sizes="180x180" href="./assets/icons/icon-180.png" />
  <link rel="apple-touch-icon" sizes="167x167" href="./assets/icons/icon-167.png" />
  <link rel="apple-touch-icon" sizes="152x152" href="./assets/icons/icon-152.png" />
  <link rel="apple-touch-icon" sizes="120x120" href="./assets/icons/icon-120.png" />
  <!-- iPadOS Startup Images (Splash Screens) -->
  <link rel="apple-touch-startup-image" href="./assets/icons/icon-512.png"
    media="(device-width: 768px) and (device-height: 1024px) and (-webkit-device-pixel-ratio: 2)" />
  <link rel="apple-touch-startup-image" href="./assets/icons/icon-512.png"
    media="(device-width: 834px) and (device-height: 1112px) and (-webkit-device-pixel-ratio: 2)" />
  <link rel="apple-touch-startup-image" href="./assets/icons/icon-512.png"
    media="(device-width: 834px) and (device-height: 1194px) and (-webkit-device-pixel-ratio: 2)" />
  <link rel="apple-touch-startup-image" href="./assets/icons/icon-512.png"
    media="(device-width: 1024px) and (device-height: 1366px) and (-webkit-device-pixel-ratio: 2)" />
  <link rel="icon" type="image/png" sizes="32x32" href="./assets/icons/favicon-32.png" />

  <title>Panda Violin | Violin Practice Companion</title>
  <!-- Premium Pediatric Typography -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Fredoka:wght@400;600;700;800;900&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="./src/styles/app.css" />
</head>

<body>
  <a href="#main-content" class="skip-link">Skip to content</a>

  <!-- Dynamic SVG Background System -->
  <svg class="global-animated-bg" aria-hidden="true" xmlns="http://www.w3.org/2000/svg" width="100%" height="100%">
    <defs>
      <filter id="bg-glow">
        <feGaussianBlur stdDeviation="3" result="coloredBlur" />
        <feMerge>
          <feMergeNode in="coloredBlur" />
          <feMergeNode in="SourceGraphic" />
        </feMerge>
      </filter>
    </defs>
    <!-- Stars, notes, and bamboo elements will be animated via CSS -->
    <g class="bg-layer stars">
      <circle cx="10%" cy="20%" r="2" fill="#FFF" opacity="0.6" />
      <circle cx="85%" cy="15%" r="3" fill="#FFF" opacity="0.4" />
      <circle cx="40%" cy="80%" r="1.5" fill="#FFF" opacity="0.8" />
      <circle cx="70%" cy="60%" r="2.5" fill="#FFF" opacity="0.5" />
      <circle cx="20%" cy="50%" r="2" fill="#FFF" opacity="0.7" />
    </g>
    <g class="bg-layer notes" fill="#FFC872" filter="url(#bg-glow)" opacity="0.2">
      <text x="15%" y="70%" font-size="60" class="float-1">‚ô´</text>
      <text x="80%" y="85%" font-size="45" class="float-2">‚ô™</text>
      <text x="90%" y="30%" font-size="70" class="float-3">‚ô¨</text>
      <text x="30%" y="15%" font-size="40" class="float-2">‚ô©</text>
    </g>
  </svg>

  <!-- App Container -->
  <div id="app" class="app-container">
    <header class="app-topbar glass" role="banner">
      <div class="app-topbar-brand">
        <span class="app-topbar-title">Panda Violin</span>
        <span class="app-topbar-subtitle">Today&rsquo;s Practice</span>
        <span class="rt-listening-chip" data-rt-indicator>Mic off</span>
      </div>
      <a href="#view-parent" class="parent-zone-lock" data-parent-lock aria-label="Open Parent Zone">
        <span class="parent-zone-lock-icon" aria-hidden="true">
          <svg viewBox="0 0 24 24" fill="currentColor">
            <path
              d="M18 8h-1V6a5 5 0 0 0-10 0v2H6a2 2 0 0 0-2 2v10a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V10a2 2 0 0 0-2-2Zm-6 9a2 2 0 1 1 0-4 2 2 0 0 1 0 4ZM9 8V6a3 3 0 1 1 6 0v2H9Z" />
          </svg>
        </span>
        <span class="parent-zone-lock-label">For Grown-Ups</span>
      </a>
    </header>

    <!-- Main Content Area -->
    <main class="main-content" id="main-content" data-initial-view-id="view-home">
      <h1 class="sr-only">Panda Violin</h1>
      <section class="view" id="view-home" aria-label="Home">
        <div class="home-kid-hero">
          <picture>
            <source srcset="./assets/illustrations/epic_mascot.png" type="image/png">
            <img src="./assets/illustrations/epic_mascot.png" alt="Epic Red Panda coach" class="home-mascot"
              decoding="async" loading="eager" width="1024" height="1024"
              style="filter: drop-shadow(0 20px 40px rgba(0,255,255,0.4)); transform: scale(1.1) translateY(10px);">
          </picture>
          <div class="home-kid-welcome">
            <h1 class="home-kid-title">Ready to play?</h1>
            <p class="home-kid-streak">üî• <span data-progress="home-streak">0</span> day streak!</p>
          </div>
        </div>

        <div class="home-giant-actions">
          <a href="#view-coach" class="btn btn-primary btn-giant">
            <span class="btn-giant-icon">üêº</span>
            <span class="btn-giant-text">Practice Coach</span>
          </a>

          <a href="#view-games" class="btn btn-giant btn-game">
            <span class="btn-giant-icon">üéÆ</span>
            <span class="btn-giant-text">Play Games</span>
          </a>

          <a href="#view-songs" class="btn btn-giant btn-song">
            <span class="btn-giant-icon">üéµ</span>
            <span class="btn-giant-text">Play Songs</span>
          </a>

          <a href="#view-tuner" class="btn btn-giant btn-tool">
            <span class="btn-giant-icon">üé∏</span>
            <span class="btn-giant-text">Panda Tuner</span>
          </a>
        </div>

        <div class="home-utility-links glass" aria-label="App links">
          <a class="btn btn-ghost" href="#view-settings" data-home-utility="settings">Settings</a>
          <a class="btn btn-ghost" href="#view-progress" data-home-utility="progress">Wins</a>
        </div>
      </section>
    </main>

    <!-- Bottom Navigation -->
    <nav class="bottom-nav glass" aria-label="Primary">
      <a href="#view-coach" class="nav-item">
        <span class="nav-icon"><svg viewBox="0 0 24 24" fill="currentColor" aria-hidden="true">
            <path
              d="M20 2H4c-1.1 0-2 .9-2 2v18l4-4h14c1.1 0 2-.9 2-2V4c0-1.1-.9-2-2-2zm-3 12H7v-2h10v2zm0-3H7V9h10v2zm0-3H7V6h10v2z" />
          </svg></span>
        <span class="nav-label">Practice</span>
      </a>
      <a href="#view-games" class="nav-item">
        <span class="nav-icon"><svg viewBox="0 0 24 24" fill="currentColor" aria-hidden="true">
            <path
              d="M21 6H3c-1.1 0-2 .9-2 2v8c0 1.1.9 2 2 2h18c1.1 0 2-.9 2-2V8c0-1.1-.9-2-2-2zm-10 7H9v2H7v-2H5v-2h2V9h2v2h2v2zm4.5 2c-.83 0-1.5-.67-1.5-1.5s.67-1.5 1.5-1.5 1.5.67 1.5 1.5-.67 1.5-1.5 1.5zm4-3c-.83 0-1.5-.67-1.5-1.5S18.67 9 19.5 9s1.5.67 1.5 1.5-.67 1.5-1.5 1.5z" />
          </svg></span>
        <span class="nav-label">Games</span>
      </a>
      <a href="#view-songs" class="nav-item">
        <span class="nav-icon"><svg viewBox="0 0 24 24" fill="currentColor" aria-hidden="true">
            <path d="M12 3v10.55c-.59-.34-1.27-.55-2-.55C7.79 13 6 14.79 6 17s1.79 4 4 4 4-1.79 4-4V7h4V3h-6z" />
          </svg></span>
        <span class="nav-label">Songs</span>
      </a>
    </nav>

  </div>

  <!-- Game Complete Modal -->
  <dialog id="game-complete-modal" class="game-complete-dialog" aria-labelledby="game-complete-heading"
    aria-modal="true">
    <div class="game-complete-inner">
      <div class="game-complete-confetti" aria-hidden="true">
        <span class="confetti-piece"
          style="left:10%;--fall-delay:0s;--fall-dur:1.6s;--fall-drift:20px;background:#E95639"></span>
        <span class="confetti-piece"
          style="left:20%;--fall-delay:0.1s;--fall-dur:1.9s;--fall-drift:-15px;background:#F9A93F"></span>
        <span class="confetti-piece"
          style="left:30%;--fall-delay:0.2s;--fall-dur:1.7s;--fall-drift:30px;background:#4FB69E"></span>
        <span class="confetti-piece"
          style="left:40%;--fall-delay:0.05s;--fall-dur:2.0s;--fall-drift:-25px;background:#E95639"></span>
        <span class="confetti-piece"
          style="left:50%;--fall-delay:0.15s;--fall-dur:1.5s;--fall-drift:10px;background:#F9A93F"></span>
        <span class="confetti-piece"
          style="left:60%;--fall-delay:0.3s;--fall-dur:1.8s;--fall-drift:-20px;background:#4FB69E"></span>
        <span class="confetti-piece"
          style="left:70%;--fall-delay:0.0s;--fall-dur:2.1s;--fall-drift:25px;background:#E95639"></span>
        <span class="confetti-piece"
          style="left:80%;--fall-delay:0.25s;--fall-dur:1.6s;--fall-drift:-10px;background:#F9A93F"></span>
        <span class="confetti-piece"
          style="left:90%;--fall-delay:0.1s;--fall-dur:1.9s;--fall-drift:15px;background:#4FB69E"></span>
        <span class="confetti-piece"
          style="left:15%;--fall-delay:0.4s;--fall-dur:1.7s;--fall-drift:-30px;background:#E95639"></span>
        <span class="confetti-piece"
          style="left:55%;--fall-delay:0.35s;--fall-dur:2.0s;--fall-drift:20px;background:#F9A93F"></span>
        <span class="confetti-piece"
          style="left:75%;--fall-delay:0.2s;--fall-dur:1.5s;--fall-drift:-15px;background:#4FB69E"></span>
      </div>
      <picture>
        <source srcset="./assets/illustrations/mascot-celebrate.webp" type="image/webp">
        <img src="./assets/illustrations/mascot-celebrate.png" alt="Tap for a hint!" class="game-complete-mascot"
          width="100" height="100" decoding="async" data-coach-action="hint" role="button" tabindex="0">
      </picture>
      <h2 id="game-complete-heading" class="game-complete-heading">Great job, Emerson!</h2>
      <div class="game-complete-stars" aria-label="Stars earned" id="game-complete-stars">
        <span class="game-complete-star filled" aria-hidden="true">‚òÖ</span>
        <span class="game-complete-star filled" aria-hidden="true">‚òÖ</span>
        <span class="game-complete-star filled" aria-hidden="true">‚òÖ</span>
      </div>
      <div class="game-complete-stats">
        <div class="game-complete-stat">
          <span class="game-complete-stat-value" id="game-complete-score">‚Äî</span>
          <span class="game-complete-stat-label">Score</span>
        </div>
        <div class="game-complete-stat">
          <span class="game-complete-stat-value" id="game-complete-accuracy">‚Äî</span>
          <span class="game-complete-stat-label">Accuracy</span>
        </div>
      </div>
      <div class="game-complete-actions">
        <button type="button" id="game-complete-play-again" class="btn btn-primary">Play Again</button>
        <a href="#view-games" id="game-complete-back" class="btn btn-secondary">Back to Games</a>
      </div>
    </div>
  </dialog>

  <dialog id="achievement-modal" aria-modal="true" aria-labelledby="achievement-heading">
    <div class="achievement-inner">
      <div class="achievement-confetti" aria-hidden="true">
        <span class="confetti-piece"
          style="--fall-delay:0s;--fall-dur:1.1s;--fall-drift:-30px;background:#E95639"></span>
        <span class="confetti-piece"
          style="--fall-delay:0.1s;--fall-dur:1.3s;--fall-drift:20px;background:#F9A93F"></span>
        <span class="confetti-piece"
          style="--fall-delay:0.2s;--fall-dur:1.0s;--fall-drift:40px;background:#4FB69E"></span>
        <span class="confetti-piece"
          style="--fall-delay:0.05s;--fall-dur:1.4s;--fall-drift:-50px;background:#FFF9F3"></span>
        <span class="confetti-piece"
          style="--fall-delay:0.3s;--fall-dur:1.2s;--fall-drift:10px;background:#E95639"></span>
        <span class="confetti-piece"
          style="--fall-delay:0.15s;--fall-dur:0.9s;--fall-drift:-20px;background:#F9A93F"></span>
        <span class="confetti-piece"
          style="--fall-delay:0.25s;--fall-dur:1.5s;--fall-drift:60px;background:#4FB69E"></span>
        <span class="confetti-piece"
          style="--fall-delay:0.4s;--fall-dur:1.1s;--fall-drift:-40px;background:#FFF9F3"></span>
        <span class="confetti-piece"
          style="--fall-delay:0.35s;--fall-dur:1.3s;--fall-drift:30px;background:#E95639"></span>
        <span class="confetti-piece"
          style="--fall-delay:0.45s;--fall-dur:1.0s;--fall-drift:-10px;background:#F9A93F"></span>
        <span class="confetti-piece"
          style="--fall-delay:0.5s;--fall-dur:1.2s;--fall-drift:50px;background:#4FB69E"></span>
        <span class="confetti-piece"
          style="--fall-delay:0.55s;--fall-dur:1.4s;--fall-drift:-60px;background:#FFF9F3"></span>
      </div>
      <div class="achievement-badge-art" id="achievement-badge-art" role="img" aria-label="">
        <img id="achievement-badge-img" src="" alt="" width="120" height="120" loading="eager">
        <span class="achievement-badge-fallback" id="achievement-badge-fallback" aria-hidden="true"></span>
      </div>
      <h2 id="achievement-heading" class="achievement-heading">New Badge!</h2>
      <p class="achievement-badge-name" id="achievement-badge-name"></p>
      <p class="achievement-cheer">You earned it, Emerson!</p>
      <button id="achievement-yay" class="btn btn-primary achievement-yay">Yay!</button>
    </div>
  </dialog>

  <!-- Exit Confirmation Modal -->
  <dialog id="exit-confirm-modal" class="exit-confirm-dialog glass" aria-labelledby="exit-confirm-heading"
    aria-modal="true">
    <div class="exit-confirm-inner">
      <picture>
        <source srcset="./assets/illustrations/mascot-sad.webp" type="image/webp">
        <img src="./assets/illustrations/mascot-sad.png" alt="" class="exit-confirm-mascot" width="100" height="100"
          decoding="async">
      </picture>
      <h2 id="exit-confirm-heading" class="exit-confirm-heading">Stop playing?</h2>
      <p class="exit-confirm-text">You are doing great! Are you sure you want to exit your game?</p>
      <div class="exit-confirm-actions">
        <button type="button" id="exit-confirm-keep-playing" class="btn btn-primary" autofocus>Keep Playing</button>
        <button type="button" id="exit-confirm-exit" class="btn btn-secondary">Exit Game</button>
      </div>
    </div>
  </dialog>

  <div class="install-toast glass" id="install-toast" role="status" aria-live="polite" hidden>
    <picture>
      <source srcset="./assets/illustrations/mascot-happy.webp" type="image/webp">
      <img src="./assets/illustrations/mascot-happy.png" alt="" class="install-toast-mascot" loading="lazy"
        decoding="async" width="64" height="64" />
    </picture>
    <div class="install-toast-body">
      <p class="install-toast-text">Play offline anytime!</p>
      <button class="btn btn-primary btn-sm" type="button" data-install-toast-action>Install</button>
    </div>
    <button class="install-toast-close" type="button" aria-label="Dismiss">
      <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5" stroke-linecap="round"
        aria-hidden="true" width="16" height="16">
        <path d="M18 6L6 18M6 6l12 12" />
      </svg>
    </button>
  </div>

  <script type="module" src="./src/app.js"></script>
</body>

</html>